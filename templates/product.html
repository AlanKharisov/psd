<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{.Product.Name}}</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body{margin:0;font-family:system-ui,Arial;background:#f4f4f4;color:#111}
        header{background:#111;color:#fff;padding:12px 18px;display:flex;justify-content:space-between;align-items:center}
        header a{color:#fff;text-decoration:none;font-size:14px}
        .container{max-width:1100px;margin:20px auto;padding:0 16px}
        .wrap{display:grid;grid-template-columns:1fr 1.2fr;gap:22px;background:#fff;border-radius:14px;padding:18px}
        @media(max-width:820px){.wrap{grid-template-columns:1fr}}
        .img img{width:100%;height:380px;object-fit:contain;background:#fafafa;border-radius:12px}
        .badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
        .badge{font-size:11px;padding:3px 8px;border-radius:999px;background:#eee}
        .badge.new{background:#0a7c3b;color:#fff}
        .badge.limited{background:#c77700;color:#fff}
        .badge.sold{background:#b00020;color:#fff}
        h1{margin:6px 0;font-size:26px}
        .brand{font-size:14px;color:#777}
        .priceRow{margin:12px 0;display:flex;align-items:baseline;gap:10px;flex-wrap:wrap}
        .price{font-size:26px;font-weight:900}
        .old{font-size:16px;color:#888;text-decoration:line-through}
        .sale{font-size:18px;font-weight:800;color:#d1001f}
        .meta{font-size:14px;color:#444;line-height:1.7;margin:10px 0}
        .stock{margin:10px 0;font-weight:700}
        .ok{color:#0a7c3b} .zero{color:#b00020}
        .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
        .btn{padding:10px 16px;border-radius:10px;border:none;cursor:pointer;font-size:14px}
        .btn-buy{background:#111;color:#fff}
        .btn-buy[disabled]{background:#aaa;cursor:not-allowed}
        .btn-ghost{background:#eee}
        .desc{margin-top:16px;font-size:15px;line-height:1.6;color:#333}
        .stars{margin:8px 0;font-size:18px}
        .stars span{color:#ffb400}
        .stars small{color:#777;font-size:13px}
        .rate{margin-top:10px;padding-top:10px;border-top:1px solid #eee}
        .rate button{margin-right:6px;padding:6px 10px;border-radius:10px;border:1px solid #ddd;background:#fff;cursor:pointer}
        .rate button:hover{background:#f6f6f6}
    </style>
</head>

<body>
<header>
    <a href="/">‚Üê –ö–∞—Ç–∞–ª–æ–≥</a>
    <a href="/cart">üõí –ö–æ—Ä–∑–∏–Ω–∞ ({{.CartCount}})</a>
</header>

<div class="container">
    <div class="wrap">
        <div class="img">
            <img src="{{.Product.Photo}}" alt="{{.Product.Name}}">
        </div>

        <div>
            <div class="badges">
                {{/* NEW –º–æ–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å –±–µ–∑ now: –µ—Å–ª–∏ StarsCount/CreatedAt –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ –±–µ–π–¥–∂ */}}
                {{/* –ï—Å–ª–∏ —Ö–æ—á–µ—à—å NEW —Å—Ç—Ä–æ–≥–æ –ø–æ –¥–∞—Ç–µ ‚Äî —Å–¥–µ–ª–∞–µ–º —á–µ—Ä–µ–∑ FuncMap –ø–æ–∑–∂–µ */}}
                <span class="badge">ID: {{.Product.ID}}</span>

                {{if .Product.Limited}}<span class="badge limited">LIMITED</span>{{end}}
                {{if and .Product.Limited (eq .Product.Qty 0)}}<span class="badge sold">SOLD OUT</span>{{end}}
            </div>

            <div class="brand">{{.Product.Brand}} ‚Ä¢ {{.Product.Category}}</div>
            <h1>{{.Product.Name}}</h1>

            <!-- Stars -->
            <div class="stars">
        <span>
          {{/* —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —Å—á–∏—Ç–∞–µ–º –≤ Go: StarsSum/StarsCount, –Ω–æ –ø–æ–∫–∞ –ø–æ–∫–∞–∂–µ–º –ø—Ä–æ—Å—Ç–æ count */}}
          ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ
        </span>
                <small>
                    (–≥–æ–ª–æ—Å–æ–≤: {{.Product.StarsCount}})
                </small>
            </div>

            <!-- Prices -->
            <div class="priceRow">
                <div class="price">‚Ç¥{{printf "%.2f" .Product.Price}}</div>

                {{if gt .Product.OldPrice 0.0}}
                <div class="old">‚Ç¥{{printf "%.2f" .Product.OldPrice}}</div>
                {{end}}

                {{if gt .Product.SalePrice 0.0}}
                <div class="sale">‚Ç¥{{printf "%.2f" .Product.SalePrice}}</div>
                {{end}}

                {{if gt .Product.DoublePrice 0.0}}
                <div class="badge">Veteran: ‚Ç¥{{printf "%.2f" .Product.DoublePrice}}</div>
                {{end}}
            </div>

            <!-- Stock -->
            {{if .Product.Limited}}
            {{if gt .Product.Qty 0}}
            <div class="stock ok">–í –Ω–∞–ª–∏—á–∏–∏: {{.Product.Qty}} —à—Ç.</div>
            {{else}}
            <div class="stock zero">–ü—Ä–æ–¥–∞–Ω–æ (0 —à—Ç.)</div>
            {{end}}
            {{else}}
            <div class="stock ok">–í –Ω–∞–ª–∏—á–∏–∏</div>
            {{end}}

            <div class="meta">
                <b>SKU:</b> {{.Product.SKU}}<br>
                <b>Color:</b> {{.Product.Color}}<br>
                <b>Size:</b> {{.Product.Size}}<br>
                <b>Weight:</b> {{.Product.Weight}}
            </div>

            <!-- Buy -->
            <div class="actions">
                <form method="POST" action="/cart/add" style="margin:0">
                    <input type="hidden" name="id" value="{{.Product.ID}}">
                    <input type="hidden" name="redirect_to" value="/product?id={{.Product.ID}}">
                    <button class="btn btn-buy" type="submit"
                            {{if and .Product.Limited (eq .Product.Qty 0)}}disabled{{end}}>
                        –ö—É–ø–∏—Ç—å / –í –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>

                <a href="/cart"><button class="btn btn-ghost" type="button">–û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button></a>
            </div>

            <!-- Rate (1..5) -->
            <div class="rate">
                <div style="font-weight:700;margin-bottom:6px">–ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É (1 —Ä–∞–∑ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç):</div>
                <form method="POST" action="/rate" style="margin:0">
                    <input type="hidden" name="id" value="{{.Product.ID}}">
                    <button name="star" value="1" type="submit">1‚òÖ</button>
                    <button name="star" value="2" type="submit">2‚òÖ</button>
                    <button name="star" value="3" type="submit">3‚òÖ</button>
                    <button name="star" value="4" type="submit">4‚òÖ</button>
                    <button name="star" value="5" type="submit">5‚òÖ</button>
                </form>
                <div style="color:#777;font-size:12px;margin-top:6px">
                    –ï—Å–ª–∏ –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚Äî –ø–µ—Ä–µ–∫–∏–Ω–µ—Ç –Ω–∞ /login.
                </div>
            </div>

            <div class="desc">{{.Product.Description}}</div>
        </div>
    </div>
</div>
</body>
</html>
